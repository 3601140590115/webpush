<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Menú Gourmet Premium</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --color-primary: #e63946;
  --color-primary-light: #f28482;
  --color-dark: #1d1e20;
  --color-darker: #121212;
  --color-light: #f8f9fa;
  --color-gray: #2a2c30;
  --color-gray-light: #3d4046;
  --color-gold: #d4af37;
  --color-gradient: linear-gradient(135deg, #e63946 0%, #d4af37 100%);
  --radius-lg: 16px;
  --radius-md: 12px;
  --radius-sm: 8px;
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  --transition: all 0.3s ease;
}

* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

body {
  font-family: 'Inter', sans-serif;
  background: var(--color-darker);
  color: var(--color-light);
  line-height: 1.6;
  overflow: hidden;
  height: 100vh;
}

.app-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 16px;
}

/* HEADER ESTILO PREMIUM */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 0;
  margin-bottom: 10px;
  position: relative;
}

.header::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: var(--color-gradient);
  opacity: 0.3;
}

#header-title {
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  font-size: 2.2rem;
  background: var(--color-gradient);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  letter-spacing: 0.5px;
}

.btn-categorias {
  background: var(--color-gradient);
  color: white;
  border: none;
  border-radius: var(--radius-md);
  padding: 12px 20px;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  box-shadow: var(--shadow);
}

.btn-categorias:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(230, 57, 70, 0.4);
}

/* BARRA DE BÚSQUEDA ELEGANTE */
.barra-busqueda {
  padding: 16px 0;
  position: relative;
}

.barra-busqueda input {
  width: 100%;
  padding: 16px 20px 16px 48px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-gray);
  background: var(--color-gray);
  color: var(--color-light);
  font-size: 1rem;
  transition: var(--transition);
  box-shadow: var(--shadow);
}

.barra-busqueda input:focus {
  outline: none;
  border-color: var(--color-primary);
  background: var(--color-gray-light);
}

.barra-busqueda::before {
  content: '\F52A';
  font-family: 'bootstrap-icons';
  position: absolute;
  left: 20px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--color-primary-light);
  z-index: 2;
  font-size: 1.2rem;
}

/* CONTENEDOR PRINCIPAL */
.main-content {
  flex: 1;
  padding: 10px 0 20px;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.products-container {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  background: var(--color-gray);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  transition: var(--transition);
  position: relative;
}

.products-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--color-gradient);
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

.products-container ul {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
}

.products-container::-webkit-scrollbar {
  width: 8px;
}

.products-container::-webkit-scrollbar-thumb {
  background: var(--color-primary);
  border-radius: 4px;
}

.products-container::-webkit-scrollbar-thumb:hover {
  background: var(--color-primary-light);
}

.products-container::-webkit-scrollbar-track {
  background: var(--color-gray-light);
  border-radius: 4px;
}

/* TARJETAS DE PRODUCTO PREMIUM */
.producto-item {
  background: var(--color-dark);
  border-radius: var(--radius-md);
  padding: 20px;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  flex-direction: column;
  height: 100%;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.producto-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 28px rgba(230, 57, 70, 0.25);
  border-color: var(--color-primary);
}

.producto-item::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--color-gradient);
  opacity: 0;
  transition: var(--transition);
}

.producto-item:hover::after {
  opacity: 1;
}

.producto-imagen {
  width: 100%;
  height: 180px;
  object-fit: cover;
  border-radius: var(--radius-sm);
  margin-bottom: 16px;
  transition: var(--transition);
}

.producto-item:hover .producto-imagen {
  transform: scale(1.03);
}

.producto-info {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.producto-nombre {
  font-weight: 600;
  font-size: 1.1rem;
  margin-bottom: 8px;
  line-height: 1.4;
}

.producto-detalle {
  color: #a0a0a0;
  font-size: 0.9rem;
  margin-bottom: 16px;
  flex: 1;
}

.producto-pie {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: auto;
}

.producto-precio {
  font-weight: 700;
  font-family: monospace;
  padding: 8px 16px;
  border-radius: var(--radius-sm);
  background: var(--color-gradient);
  color: white;
  transition: var(--transition);
  font-size: 1.1rem;
}

.producto-boton {
  background: transparent;
  border: 1px solid var(--color-primary);
  color: var(--color-primary);
  border-radius: var(--radius-sm);
  padding: 8px 16px;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 500;
}

.producto-boton:hover {
  background: var(--color-primary);
  color: white;
}

/* MODALES DE LUJO */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(5px);
  justify-content: center;
  align-items: center;
  z-index: 1300;
  padding: 16px;
  transition: opacity 0.3s ease;
}

.modal-content {
  background: var(--color-dark);
  padding: 32px;
  border-radius: var(--radius-lg);
  width: 95%;
  max-width: 500px;
  text-align: center;
  position: relative;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(255, 255, 255, 0.1);
  animation: modalAppear 0.4s ease;
}

@keyframes modalAppear {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.modal-content::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--color-gradient);
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

.modal-content img {
  width: 100%;
  max-width: 320px;
  border-radius: var(--radius-md);
  margin-bottom: 24px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

.modal-content h3 {
  margin: 8px 0 12px;
  font-size: 1.8rem;
  font-family: 'Playfair Display', serif;
  color: white;
}

.modal-content .modal-precio {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--color-gold);
  margin-bottom: 16px;
  font-family: monospace;
}

.modal-content .modal-detalle {
  margin: 16px 0;
  color: #d0d0d0;
  line-height: 1.6;
  font-size: 1.05rem;
}

/* BOTÓN CERRAR MODAL ELEGANTE */
.close-modal {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 40px;
  height: 40px;
  background: var(--color-primary);
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  z-index: 10;
}

.close-modal:hover {
  transform: rotate(90deg) scale(1.1);
  background: var(--color-primary-light);
}

/* MODAL CATEGORÍAS MEJORADO */
#lista-categorias {
  list-style: none;
  padding: 0;
  max-height: 320px;
  overflow-y: auto;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 12px;
  margin-top: 16px;
}

#lista-categorias li {
  background: var(--color-gray);
  padding: 16px 12px;
  border-radius: var(--radius-md);
  text-align: center;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 500;
  border: 1px solid transparent;
}

#lista-categorias li:hover {
  background: var(--color-primary);
  transform: translateY(-3px);
  box-shadow: 0 6px 16px rgba(230, 57, 70, 0.3);
}

/* ESTILOS PARA BÚSQUEDA */
mark {
  background: var(--color-primary);
  color: white;
  border-radius: 2px;
  padding: 0 2px;
}

/* RESPONSIVE */
@media (max-width: 768px) {
  .app-container {
    padding: 0 12px;
  }
  
  #header-title {
    font-size: 1.8rem;
  }
  
  .products-container ul {
    grid-template-columns: 1fr;
  }
  
  .modal-content {
    padding: 24px;
  }
  
  #lista-categorias {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* EFECTO DE CARGA MEJORADO */
.loading {
  position: relative;
  overflow: hidden;
}

.loading::after {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  transform: translateX(-100%);
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0) 0,
    rgba(255, 255, 255, 0.1) 20%,
    rgba(255, 255, 255, 0.2) 60%,
    rgba(255, 255, 255, 0)
  );
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  100% {
    transform: translateX(100%);
  }
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #888;
}

.empty-state i {
  font-size: 3rem;
  margin-bottom: 16px;
  opacity: 0.5;
}

.empty-state p {
  font-size: 1.1rem;
}
</style>
</head>
<body>

<div class="app-container">
  <header class="header">
    <h1 id="header-title">Menú Gourmet</h1>
    <button id="btn-categorias" class="btn-categorias">
      <i class="bi bi-grid-fill"></i>
      <span>Categorías</span>
    </button>
  </header>

  <div class="barra-busqueda">
    <input type="text" id="busqueda" placeholder="Buscar producto...">
  </div>

  <div class="main-content">
    <main id="productos" class="products-container">
      <div class="empty-state">
        <i class="bi bi-egg-fried"></i>
        <p>Cargando deliciosos platos...</p>
      </div>
    </main>
  </div>

  <!-- Modal Producto -->
  <div id="modal-producto" class="modal" aria-hidden="true">
    <div class="modal-content">
      <button id="close-modal-producto" class="close-modal">×</button>
      <img id="modal-img" src="imagenes/categorias/default/default.png" alt="Imagen Producto">
      <h3 id="modal-name"></h3>
      <p id="modal-price" class="modal-precio"></p>
      <p id="modal-detalle" class="modal-detalle"></p>
    </div>
  </div>

  <!-- Modal Categorías -->
  <div id="modal-categorias" class="modal" aria-hidden="true">
    <div class="modal-content">
      <button id="close-modal" class="close-modal">×</button>
      <h2 style="margin-bottom:20px; font-family: 'Playfair Display', serif;">Selecciona una Categoría</h2>
      <div style="position:relative;">
        <input type="text" id="busqueda-categoria" placeholder="Buscar categoría..." style="margin-bottom:20px; width:100%; padding:12px 16px 12px 40px; border-radius:var(--radius-md); border:1px solid var(--color-gray); background:var(--color-gray); color:var(--color-light);">
        <i class="bi bi-search" style="position:absolute; left:16px; top:50%; transform:translateY(-50%); color:var(--color-primary-light);"></i>
      </div>
      <ul id="lista-categorias"></ul>
    </div>
  </div>
</div>

<script type="module">
async function main(){
  // Simular carga de datos
  document.getElementById('productos').innerHTML = `
    <div class="empty-state">
      <i class="bi bi-egg-fried"></i>
      <p>Cargando deliciosos platos...</p>
    </div>
  `;
  
  try {
    const res = await fetch("menu_data.json");
    const data = await res.json();
    const categorias = data.categorias||[], productos = data.productos||[];
    let categoriaSeleccionada = categorias[0]||"";

    const listaCategorias = document.getElementById("lista-categorias");
    const contenedorProductos = document.getElementById("productos");
    const inputBusqueda = document.getElementById("busqueda");
    const inputBusquedaCategoria = document.getElementById("busqueda-categoria");
    const modalCategorias = document.getElementById("modal-categorias");
    const btnModal = document.getElementById("btn-categorias");
    const headerTitle = document.getElementById("header-title");

    const modalProducto = document.getElementById('modal-producto');
    const modalName = document.getElementById('modal-name');
    const modalPrice = document.getElementById('modal-price');
    const modalDetalle = document.getElementById('modal-detalle');
    const modalImg = document.getElementById('modal-img');
    const closeModalProductoBtn = document.getElementById('close-modal-producto');

    const normalizar = str => (str||'').toLowerCase().trim();
    
    function resaltarTexto(texto,palabras){
      let r = texto||'';
      palabras.forEach(p => { 
        if (p.length>2) r = r.replace(new RegExp(p,'gi'), m=>`<mark>${m}</mark>`); 
      });
      return r;
    }
    
    function filtrarProductos(lista, query){
      const palabras = normalizar(query).split(/\s+/).filter(p=>p.length>2);
      if(!palabras.length) return lista;
      return lista.map(p=>{
        const t = normalizar(`${p.nombre} ${p.categoria} ${p.detalle||''}`);
        const c = palabras.reduce((a,w)=>t.includes(w)?a+1:a,0);
        return {...p, coincidencias:c, nombreResaltado:resaltarTexto(p.nombre,palabras)};
      }).filter(p=>p.coincidencias>0).sort((a,b)=>b.coincidencias-a.coincidencias);
    }

    function renderCategorias(filtro=""){
      const filtroNorm = normalizar(filtro);
      let listaFiltrada = categorias.filter(c=>normalizar(c).includes(filtroNorm));
      listaCategorias.innerHTML = listaFiltrada.map(c=>`
        <li data-cat="${c}">
          <i class="bi bi-tag" style="margin-right:8px;"></i>${c}
        </li>
      `).join('');
      
      listaCategorias.querySelectorAll('li').forEach(li=>{
        li.addEventListener('click',()=>{
          categoriaSeleccionada = li.dataset.cat;
          inputBusqueda.value=''; 
          inputBusquedaCategoria.value='';
          renderProductos();
          modalCategorias.style.display='none';
          document.body.style.overflow='';
        });
      });
    }

    function renderProductos(){
      const q = inputBusqueda.value.trim();
      const lista = q.length>0 ? filtrarProductos(productos,q) : productos.filter(p=>p.categoria===categoriaSeleccionada);
      headerTitle.textContent = q ? `"${q}"` : (categoriaSeleccionada||'Menú');

      if (lista.length === 0) {
        contenedorProductos.innerHTML = `
          <div class="empty-state">
            <i class="bi bi-search"></i>
            <p>No encontramos resultados para "${q}"</p>
            <p style="font-size:0.9rem; margin-top:8px;">Intenta con otros términos de búsqueda</p>
          </div>
        `;
        return;
      }

      const html = "<ul>" + lista.map(p=>`
          <li class="producto-item"
              data-name="${p.nombre}"
              data-price="${p.precio||0}"
              data-img="${(p.imagen?.ruta)||'imagenes/categorias/default/default.png'}"
              data-detalle="${(p.detalle||'').replace(/\"/g,'&quot;')}">
            <img src="${(p.imagen?.ruta)||'imagenes/categorias/default/default.png'}" 
                 alt="${p.nombre}" 
                 class="producto-imagen"
                 onerror="this.src='imagenes/categorias/default/default.png'">
            <div class="producto-info">
              <div class="producto-nombre">${p.nombreResaltado||p.nombre}</div>
              <div class="producto-detalle">${p.detalle||''}</div>
              <div class="producto-pie">
                <span class="producto-precio">Q${p.precio||0}</span>
                <button class="producto-boton">Ver más</button>
              </div>
            </div>
          </li>
        `).join('') + "</ul>";

      contenedorProductos.innerHTML = html;

      contenedorProductos.querySelectorAll('.producto-item').forEach(li=>{
        li.addEventListener('click',()=>{
          modalName.textContent = li.dataset.name;
          modalPrice.textContent = 'Q' + li.dataset.price;
          modalDetalle.textContent = li.dataset.detalle||'';
          modalImg.src = li.dataset.img || 'imagenes/categorias/default/default.png';
          modalProducto.style.display = 'flex';
          document.body.style.overflow = 'hidden';
        });
      });
    }

    closeModalProductoBtn.addEventListener('click', ()=>{
      modalProducto.style.display='none';
      document.body.style.overflow='';
    });
    
    window.addEventListener('keydown', e=>{ 
      if(e.key==='Escape'){ 
        modalProducto.style.display='none'; 
        modalCategorias.style.display='none'; 
        document.body.style.overflow=''; 
      } 
    });

    btnModal.addEventListener("click",()=>{
      modalCategorias.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    });
    
    document.getElementById('close-modal').addEventListener('click',()=>{
      modalCategorias.style.display='none';
      document.body.style.overflow='';
    });

    inputBusquedaCategoria.addEventListener('input',()=>renderCategorias(inputBusquedaCategoria.value));
    inputBusqueda.addEventListener('input',renderProductos);

    renderCategorias();
    renderProductos();
  } catch (error) {
    console.error("Error cargando los datos:", error);
    document.getElementById('productos').innerHTML = `
      <div class="empty-state">
        <i class="bi bi-exclamation-triangle"></i>
        <p>Error cargando el menú</p>
        <p style="font-size:0.9rem; margin-top:8px;">Por favor, intenta recargar la página</p>
      </div>
    `;
  }
}

main();
</script>
</body>
</html>