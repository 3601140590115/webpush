<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Menú Gourmet</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  /* Scrollbar personalizado para productos */
  .products-container::-webkit-scrollbar {
    width: 10px;
    background: #222;
  }
  .products-container::-webkit-scrollbar-thumb {
    background: #ff003c;
    border-radius: 8px;
    box-shadow: 0 0 8px 2px #ff003c;
  }
  .products-container::-webkit-scrollbar-thumb:hover {
    background: #ff0055;
    box-shadow: 0 0 12px 4px #ff0055;
  }
  .products-container {
    scrollbar-color: #ff003c #222;
    scrollbar-width: thin;
  }
  :root {
    --primary-color: #ff0000;
    --primary-dark: #b30000;
    --secondary-color: #111;
    --text-color: #fff;
    --header-height: 4.5rem;
    --category-height: 3.5rem;
    --slider-height: 3.2rem;
  }

  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Inter', sans-serif;
    background: var(--secondary-color);
    color: var(--text-color);
    overflow: hidden; /* nada de scroll */
    font-size: 89%;
  }

  .app-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    max-width: 581px;
    margin: 0 auto;
  }

  /* Header */
  .menu-header {
    height: var(--header-height);
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 10;
  }
  .menu-title {
    font-size: 1.31rem;
    font-weight: 700;
    position: relative;
  }
  .menu-title::after {
    content: '';
    position: absolute;
    bottom: -0.4rem;
    left: 50%;
    transform: translateX(-50%);
    width: 2.5rem;
    height: 0.2rem;
    background: var(--primary-color);
    border-radius: 3px;
  }
  .fidelidad-btn-top {
  position: absolute;
  right: 1rem;
  width: 2.19rem;
  height: 2.19rem;
  border-radius: 50%;
  background: var(--primary-color);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-size: 1.09rem;
  cursor: pointer;
  transition: background 0.2s;
  }
  .fidelidad-btn-top:hover {
  background: var(--primary-dark);
  /* No scale, mantener tamaño fijo */
  }

  /* Category */
  .category-header-panel {
    height: var(--category-height);
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    border-bottom: 2px dashed var(--primary-color);
    flex-shrink: 0;
    font-size: 0.81rem;
  }

  /* Products container */
  .products-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* permite scroll vertical */
    padding: 0.5rem 1rem;
  }

  .product-item {
    flex-shrink: 0;
    display: flex;
    justify-content: space-between;
    padding: 0.37rem 0.55rem;
    border-bottom: 1px solid var(--primary-color);
    border-radius: 0.5rem;
    background: #111;
    margin-bottom: 0.3rem;
    align-items: center;
    font-size: 0.81rem;
  }

  .product-price {
    background: #000;
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
    padding: 0.065rem 0.42rem;
    border-radius: 0.6rem;
    font-weight: 700;
    font-size: 0.72rem;
    min-width: 3.23rem;
    min-height: 1.54rem;
    max-width: 3.23rem;
    max-height: 1.54rem;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: none;
    transition: border-color 0.2s, color 0.2s, background 0.2s;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
  }

  .product-item:hover .product-price {
    background: #111;
    color: var(--primary-dark);
    border-color: var(--primary-dark);
    /* No scale, mantener tamaño fijo */
  }

  .product-item > span:first-child {
    flex: 1 1 auto;
    min-width: 0;
    margin-right: 0.5rem;
    word-break: break-word;
    overflow-wrap: break-word;
  }

  /* Slider */
  .slider-controls {
    height: var(--slider-height);
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    flex-shrink: 0;
  }

  .slider-arrow {
  width: 1.30rem;
  height: 1.30rem;
  border-radius: 50%;
  background: #000;
  color: var(--primary-color);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: 2px solid var(--primary-color);
  transition: border-color 0.2s, color 0.2s, background 0.2s;
  box-shadow: none;
  font-size: 0.82rem;
  }

  .slider-arrow:disabled {
  background: #222;
  border-color: #444;
  color: #444;
  cursor: not-allowed;
  opacity: 0.5;
  }

  .empty-category {
    text-align: center;
    margin-top: auto;
    margin-bottom: auto;
    color: #aaa;
    color: #fff;
    background: var(--primary-color);
    border-color: var(--primary-color);
  }
</style>
</head>
<body>
<div class="app-container">
  <div class="menu-header">
    <h1 class="menu-title">Menú</h1>
    <div class="fidelidad-btn-top"><i class="fas fa-id-card"></i></div>
  </div>
  <div class="category-header-panel" id="categoryHeader">Cargando...</div>
  <div class="products-container" id="productsContainer"></div>
  <div class="slider-controls" id="sliderControls"></div>
</div>

<script>
  async function renderMenuCliente() {
    const productsContainer = document.getElementById('productsContainer');
    const sliderControls = document.getElementById('sliderControls');
    const categoryHeader = document.getElementById('categoryHeader');

    try {
      // Simulación de API
      const data = await fetch('/menu_data').then(r=>r.json());
      const categorias = data.categorias || [];
      const productos = data.productos || [];

      if (!categorias.length) {
        productsContainer.innerHTML = '<div class="empty-category">No hay categorías</div>';
        return;
      }

      const categoryIcons = {
        "Entradas": "fa-leaf",
        "Platos Principales": "fa-utensils",
        "Postres": "fa-ice-cream",
        "Bebidas": "fa-glass-martini",
        "Especiales": "fa-star"
      };

  // Ahora: solo navegación por categoría, sin paginación interna
  let categoriaActual = 0;

      function renderPagina() {
        productsContainer.innerHTML = '';
        if (!categorias.length) {
          productsContainer.innerHTML = '<div class="empty-category">No hay productos</div>';
          return;
        }
        const cat = categorias[categoriaActual];
        const iconClass = categoryIcons[cat] || '';

        // Botones de categoría
        const prevCatBtn = document.createElement('button');
        prevCatBtn.className = 'slider-arrow';
        prevCatBtn.style.marginRight = '0.5rem';
        prevCatBtn.innerHTML = '<i class="fas fa-angle-double-left"></i>';
        prevCatBtn.disabled = categoriaActual === 0;
        prevCatBtn.onclick = () => {
          if (categoriaActual > 0) {
            categoriaActual--;
            renderPagina();
          }
        };

        const nextCatBtn = document.createElement('button');
        nextCatBtn.className = 'slider-arrow';
        nextCatBtn.style.marginLeft = '0.5rem';
        nextCatBtn.innerHTML = '<i class="fas fa-angle-double-right"></i>';
        nextCatBtn.disabled = categoriaActual >= (categorias.length - 1);
        nextCatBtn.onclick = () => {
          if (categoriaActual < categorias.length - 1) {
            categoriaActual++;
            renderPagina();
          }
        };

        // Renderizar header de categoría con botones
        categoryHeader.innerHTML = '';
        categoryHeader.appendChild(prevCatBtn);
        const catTitle = document.createElement('span');
        catTitle.innerHTML = (iconClass ? `<i class="fas ${iconClass}"></i> ` : '') + cat;
        categoryHeader.appendChild(catTitle);
        categoryHeader.appendChild(nextCatBtn);

        // Mostrar todos los productos de la categoría
        const prods = productos.filter(p => p.categoria === cat);
        if (!prods.length) {
          productsContainer.innerHTML = '<div class="empty-category">No hay productos en esta categoría</div>';
        } else {
          prods.forEach(prod => {
            const item = document.createElement('div');
            item.className = 'product-item';
            item.innerHTML = `<span>${prod.nombre}</span><span class='product-price'>$${prod.precio.toFixed(2)}</span>`;
            productsContainer.appendChild(item);
          });
        }

        // Sin controles de página, solo info de categoría
        sliderControls.innerHTML = '';
        const info = document.createElement('span');
        info.style.color = '#fff';
        info.textContent = `Categoría ${categoriaActual + 1} de ${categorias.length}`;
        sliderControls.appendChild(info);
      }

      renderPagina();
      window.addEventListener('resize', renderPagina);
    } catch(err) {
      console.error(err);
      productsContainer.innerHTML = '<div class="empty-category">Error al cargar el menú</div>';
    }
  }

  document.addEventListener('DOMContentLoaded', ()=>renderMenuCliente());
</script>
</body>
</html>
